{% extends "flexigrid.j2" %}

{% block main %}
<h2>{{ resource.meta.title }}</h2>
<p>
{% block person %}
{% endblock %}
</p>
{% endblock %}
{% block sidebar %}


{% set imgd = resource.node.root.node_from_relative_path("media/images/people/") %}
{% set r = imgd.contains_resource(resource.slug+".jpg") %}
{% if r %}
<img src="{{media_url('/images/people/profile_'~resource.slug~'.jpg')}}">
{% endif %}

{% set projectnode = resource.node.root.node_from_relative_path("projects/") %}
{% set all = [] %}
{% for project in projectnode.resources %}
{% for person in project.meta.people %}
{% if person+".html" == resource.name %}

{% do all.append(project) %}

{% endif %}

{% endfor %}
{% endfor %}


{% if all %}
<h2>Projects</h2>
<ul>
{% for proj in all %}
<li><a href="{{proj.full_url}}">{{proj.meta.title}}</a></li>
{% endfor %}
</ul>
{% endif %}


{% if resource.meta.links %}
<h2>Links</h2>
<ul>
{% for link in resource.meta.links %}
<li>
<a href="{{link.url}}">{{link.description}}</a>
</li>
{% endfor %}
{% endif %}

{% endblock %}