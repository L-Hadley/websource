---
extends: flexigrid.j2
title: Events
description: Diary Dates
---
{% block main %}
<div id="tables">

<div id="allevents">
<h2>Events</h2>
<table id="eventlist">
{% for res in resource.node.walk_resources() %}
{% if res.meta.extends == "events.j2" and res.is_processable %}
<tr data-start="{{res.meta.startdate.strftime("%Y-%m-%d")}}">
<td>{{res.meta.startdate.strftime("%A, %d %B %Y") }}</td>
<td><a href="{{res.full_url}}">{{res.meta.title}}</a> : {{res.meta.description}}</td>
</tr>
{% endif %}
{% endfor %}
</table>
</div>

</div> 
{% endblock %}

{% block footscripts %}
 <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to loca
l if necessary -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.js"></script>
  <script>window.jQuery || document.write('<script src="js/libs/jquery-1.5.1.min.js">\x3C/script>')</script>
<script>
var trs = $("#eventlist tr");
var now = new Date();
var isfuture = trs.map(function(i,r){return new Date($(r).data('start'))>now});
var forthcoming = $.grep(trs, function(e,i){return isfuture[i]});
var past = $.grep(trs, function(e,i){return !isfuture[i]});

$("#tables").append("<div id='coming'><h2>Coming Events</h2><table id='forth'></table></div>");
$("#forth").append(forthcoming);

$("#tables").append("<div id='past'><h2>Past Events</h2><table id='pastevents'></table></div>");
$("#pastevents").append(past);

$("#allevents").remove();

</script>
{% endblock footscripts %}
